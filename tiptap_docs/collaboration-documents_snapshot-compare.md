---
title: Snapshot Compare extension | Tiptap Editor Docs
source_url: https://tiptap.dev/docs/collaboration/documents/snapshot-compare#page-title
og:title: Snapshot Compare extension | Tiptap Editor Docs
ogDescription: Compare snapshots of your documents to see changes made between two versions.
docsearch:version: 2.x
robots: index, follow
og:image: https://tiptap.dev/docs/api/og?title=Visually%20compare%20snapshots%20of%20your%20documents&category=Collaboration
ogImage: https://tiptap.dev/docs/api/og?title=Visually%20compare%20snapshots%20of%20your%20documents&category=Collaboration
language: en
description: Compare snapshots of your documents to see changes made between two versions.
og:type: website
og:image:height: 630
og:image:width: 1200
og:locale: en_US
favicon: https://tiptap.dev/docs/favicon.png
twitter:title: Snapshot Compare extension | Tiptap Editor Docs
viewport: width=device-width, initial-scale=1
twitter:image: https://tiptap.dev/docs/api/og?title=Visually%20compare%20snapshots%20of%20your%20documents&category=Collaboration
ogUrl: https://tiptap.dev/docs/collaboration/documents/snapshot-compare
ogTitle: Snapshot Compare extension | Tiptap Editor Docs
og:description: Compare snapshots of your documents to see changes made between two versions.
og:url: https://tiptap.dev/docs/collaboration/documents/snapshot-compare
twitter:description: Compare snapshots of your documents to see changes made between two versions.
twitter:card: summary_large_image
ogLocale: en_US
scrapeId: 7727b940-c4fd-4499-9fbf-d29defb82646
sourceURL: https://tiptap.dev/docs/collaboration/documents/snapshot-compare#page-title
url: https://tiptap.dev/docs/collaboration/documents/snapshot-compare#page-title
statusCode: 200
---

![logo](data:,)

[](https://www.cookiebot.com/en/what-is-behind-powered-by-cookiebot/)

*   [Consent](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
    
*   [Details](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
    
*   [\[#IABV2SETTINGS#\]](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
    
*   [About](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
    

This website uses cookies

We use cookies to personalise content and ads, to provide social media features and to analyse our traffic. We also share information about your use of our site with our social media, advertising and analytics partners who may combine it with other information that you’ve provided to them or that they’ve collected from your use of their services.

Consent Selection

**Necessary**

**Preferences**

**Statistics**

**Marketing**

[Show details](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)

Details

*   Necessary 24
    
    Necessary cookies help make a website usable by enabling basic functions like page navigation and access to secure areas of the website. The website cannot function properly without these cookies.
    
    *   [Cookiebot\
        \
        1](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        [Learn more about this provider![](<Base64-Image-Removed>)](https://www.cookiebot.com/goto/privacy-policy/ "Cookiebot's privacy policy")
        
        **1.gif**Used to count the number of sessions to the website, necessary for optimizing CMP product delivery.
        
        **Maximum Storage Duration**: Session**Type**: Pixel Tracker
        
    *   [Google\
        \
        2](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        [Learn more about this provider![](<Base64-Image-Removed>)](https://business.safety.google/privacy/ "Google's privacy policy")
        
        Some of the data collected by this provider is for the purposes of personalization and measuring advertising effectiveness.
        
        **test\_cookie**Stores whether the user's browser has cookie support enabled.
        
        **Maximum Storage Duration**: 1 day**Type**: HTTP Cookie
        
        **ar\_debug**Checks whether a technical debugger-cookie is present.
        
        **Maximum Storage Duration**: 3 months**Type**: HTTP Cookie
        
    *   [ai-demo.tiptap.dev  \
        consent.cookiebot.com  \
        embed.tiptap.dev  \
        embed-pro.tiptap.dev  \
        \
        5](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **CookieConsent \[x5\]**Stores the user's cookie consent state for the current domain
        
        **Maximum Storage Duration**: 1 year**Type**: HTTP Cookie
        
    *   [cdn.webflow.com  \
        hsforms.com  \
        \
        3](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **\_cfuvid \[x3\]**This cookie is a part of the services provided by Cloudflare - Including load-balancing, deliverance of website content and serving DNS connection for website operators.
        
        **Maximum Storage Duration**: Session**Type**: HTTP Cookie
        
    *   [cloud.tiptap.dev\
        \
        1](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **tiptap\_cloud\_session**Assigns a unique session ID to manage and maintain their session state across page requests within the cloud application.
        
        **Maximum Storage Duration**: 1 day**Type**: HTTP Cookie
        
    *   [cloud.tiptap.dev  \
        tiptap.dev  \
        \
        4](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **debug \[x2\]**This cookie is used to detect errors on the website - this information is sent to the website's support staff in order to optimize the visitor's experience on the website.
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
        **XSRF-TOKEN \[x2\]**Ensures visitor browsing-security by preventing cross-site request forgery. This cookie is essential for the security of the website and visitor.
        
        **Maximum Storage Duration**: 1 day**Type**: HTTP Cookie
        
    *   [embed.tiptap.dev\
        \
        1](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **currentUser**Stores a username and its associated caret color, which are used in the collaboration demo to personalize the user's experience.
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
    *   [hs-analytics.net  \
        hs-banner.com  \
        \
        6](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **\_\_cf\_bm \[x6\]**This cookie is used to distinguish between humans and bots. This is beneficial for the website, in order to make valid reports on the use of their website.
        
        **Maximum Storage Duration**: 1 day**Type**: HTTP Cookie
        
    *   [x.clearbitjs.com\
        \
        1](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **pfjs%3Acookies**Used to check if the user's browser supports cookies.
        
        **Maximum Storage Duration**: 1 year**Type**: HTTP Cookie
        
    
*   Preferences 1
    
    Preference cookies enable a website to remember information that changes the way the website behaves or looks, like your preferred language or the region that you are in.
    
    *   [tiptap.dev\
        \
        1](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **loglevel**Maintains settings and outputs when using the Developer Tools Console on current session.
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
    
*   Statistics 5
    
    Statistic cookies help website owners to understand how visitors interact with websites by collecting and reporting information anonymously.
    
    *   [Hubspot\
        \
        4](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        [Learn more about this provider![](<Base64-Image-Removed>)](https://legal.hubspot.com/privacy-policy "Hubspot's privacy policy")
        
        **\_\_hssc**Identifies if the cookie data needs to be updated in the visitor's browser.
        
        **Maximum Storage Duration**: 1 day**Type**: HTTP Cookie
        
        **\_\_hssrc**Used to recognise the visitor's browser upon reentry on the website.
        
        **Maximum Storage Duration**: Session**Type**: HTTP Cookie
        
        **\_\_hstc**Sets a unique ID for the session. This allows the website to obtain data on visitor behaviour for statistical purposes.
        
        **Maximum Storage Duration**: 180 days**Type**: HTTP Cookie
        
        **hubspotutk**Sets a unique ID for the session. This allows the website to obtain data on visitor behaviour for statistical purposes.
        
        **Maximum Storage Duration**: 180 days**Type**: HTTP Cookie
        
    *   [x.clearbitjs.com\
        \
        1](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **cb%3Atest**Collects data on the user's visits to the website, such as the number of visits, average time spent on the website and what pages have been loaded with the purpose of generating reports for optimising the website content.
        
        **Maximum Storage Duration**: 1 year**Type**: HTTP Cookie
        
    
*   Marketing 54
    
    Marketing cookies are used to track visitors across websites. The intention is to display ads that are relevant and engaging for the individual user and thereby more valuable for publishers and third party advertisers.
    
    *   [Google\
        \
        3](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        [Learn more about this provider![](<Base64-Image-Removed>)](https://business.safety.google/privacy/ "Google's privacy policy")
        
        Some of the data collected by this provider is for the purposes of personalization and measuring advertising effectiveness.
        
        **NID**Pending
        
        **Maximum Storage Duration**: 6 months**Type**: HTTP Cookie
        
        **\_ga**Used to send data to Google Analytics about the visitor's device and behavior. Tracks the visitor across devices and marketing channels.
        
        **Maximum Storage Duration**: 2 years**Type**: HTTP Cookie
        
        **\_ga\_#**Used to send data to Google Analytics about the visitor's device and behavior. Tracks the visitor across devices and marketing channels.
        
        **Maximum Storage Duration**: 2 years**Type**: HTTP Cookie
        
    *   [Hubspot\
        \
        1](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        [Learn more about this provider![](<Base64-Image-Removed>)](https://legal.hubspot.com/privacy-policy "Hubspot's privacy policy")
        
        **\_\_ptq.gif**Sends data to the marketing platform Hubspot about the visitor's device and behaviour. Tracks the visitor across devices and marketing channels.
        
        **Maximum Storage Duration**: Session**Type**: Pixel Tracker
        
    *   [Leadfeeder\
        \
        1](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        [Learn more about this provider![](<Base64-Image-Removed>)](https://www.leadfeeder.com/privacy/ "Leadfeeder's privacy policy")
        
        **(unnamed)**Tracks the individual sessions on the website, allowing the website to compile statistical data from multiple visits. This data can also be used to create leads for marketing purposes.
        
        **Maximum Storage Duration**: Session**Type**: Pixel Tracker
        
    *   [Reddit\
        \
        3](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        [Learn more about this provider![](<Base64-Image-Removed>)](https://www.redditinc.com/policies/privacy-policy "Reddit's privacy policy")
        
        **rp.gif**Necessary for the implementation of the Reddit.com's share-button function.
        
        **Maximum Storage Duration**: Session**Type**: Pixel Tracker
        
        **\_rdt\_uuid \[x2\]**Used to track visitors on multiple websites, in order to present relevant advertisement based on the visitor's preferences.
        
        **Maximum Storage Duration**: Session**Type**: HTTP Cookie
        
    *   [YouTube\
        \
        10](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        [Learn more about this provider![](<Base64-Image-Removed>)](https://business.safety.google/privacy/ "YouTube's privacy policy")
        
        **LAST\_RESULT\_ENTRY\_KEY \[x2\]**Used to track user’s interaction with embedded content.
        
        **Maximum Storage Duration**: Session**Type**: HTTP Cookie
        
        **nextId**Used to track user’s interaction with embedded content.
        
        **Maximum Storage Duration**: Session**Type**: HTTP Cookie
        
        **requests**Used to track user’s interaction with embedded content.
        
        **Maximum Storage Duration**: Session**Type**: HTTP Cookie
        
        **TESTCOOKIESENABLED \[x2\]**Used to track user’s interaction with embedded content.
        
        **Maximum Storage Duration**: 1 day**Type**: HTTP Cookie
        
        **\_\_Secure-ROLLOUT\_TOKEN**Pending
        
        **Maximum Storage Duration**: 180 days**Type**: HTTP Cookie
        
        **remote\_sid**Necessary for the implementation and functionality of YouTube video-content on the website.
        
        **Maximum Storage Duration**: Session**Type**: HTTP Cookie
        
        **VISITOR\_INFO1\_LIVE**Pending
        
        **Maximum Storage Duration**: 180 days**Type**: HTTP Cookie
        
        **YSC**Pending
        
        **Maximum Storage Duration**: Session**Type**: HTTP Cookie
        
    *   [embed.tiptap.dev\
        \
        3](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **yt.innertube::nextId**Registers a unique ID to keep statistics of what videos from YouTube the user has seen.
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
        **LogsDatabaseV2:V#||LogsRequestsStore**Used to track user’s interaction with embedded content.
        
        **Maximum Storage Duration**: Persistent**Type**: IndexedDB
        
        **ServiceWorkerLogsDatabase#SWHealthLog**Necessary for the implementation and functionality of YouTube video-content on the website.
        
        **Maximum Storage Duration**: Persistent**Type**: IndexedDB
        
    *   [sc.lfeeder.com\
        \
        5](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **\_lfa\_test\_cookie\_stored \[x2\]**Used in context with Account-Based-Marketing (ABM). The cookie registers data such as IP-addresses, time spent on the website and page requests for the visit. This is used for retargeting of multiple users rooting from the same IP-addresses. ABM usually facilitates B2B marketing purposes.
        
        **Maximum Storage Duration**: Session**Type**: HTTP Cookie
        
        **\_lfa**Used in context with Account-Based-Marketing (ABM). The cookie registers data such as IP-addresses, time spent on the website and page requests for the visit. This is used for retargeting of multiple users rooting from the same IP-addresses. ABM usually facilitates B2B marketing purposes.
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
        **\_lfa\_expiry**Contains the expiry-date for the cookie with corresponding name.
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
        **\_lfa**Used in context with Account-Based-Marketing (ABM). The cookie registers data such as IP-addresses, time spent on the website and page requests for the visit. This is used for retargeting of multiple users rooting from the same IP-addresses. ABM usually facilitates B2B marketing purposes.
        
        **Maximum Storage Duration**: 1 year**Type**: HTTP Cookie
        
    *   [www.youtube-nocookie.com  \
        embed.tiptap.dev  \
        \
        22](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **#-# \[x2\]**Used to track user’s interaction with embedded content.
        
        **Maximum Storage Duration**: Session**Type**: HTML Local Storage
        
        **iU5q-!O9@\[#COOKIETABLE\_ADVERTISING#\]nbsp;\[x2\]**Registers a unique ID to keep statistics of what videos from YouTube the user has seen.
        
        **Maximum Storage Duration**: Session**Type**: HTML Local Storage
        
        **ytidb::LAST\_RESULT\_ENTRY\_KEY \[x2\]**Used to track user’s interaction with embedded content.
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
        **YtIdbMeta#databases \[x2\]**Used to track user’s interaction with embedded content.
        
        **Maximum Storage Duration**: Persistent**Type**: IndexedDB
        
        **yt-remote-cast-available \[x2\]**Stores the user's video player preferences using embedded YouTube video
        
        **Maximum Storage Duration**: Session**Type**: HTML Local Storage
        
        **yt-remote-cast-installed \[x2\]**Stores the user's video player preferences using embedded YouTube video
        
        **Maximum Storage Duration**: Session**Type**: HTML Local Storage
        
        **yt-remote-connected-devices \[x2\]**Stores the user's video player preferences using embedded YouTube video
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
        **yt-remote-device-id \[x2\]**Stores the user's video player preferences using embedded YouTube video
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
        **yt-remote-fast-check-period \[x2\]**Stores the user's video player preferences using embedded YouTube video
        
        **Maximum Storage Duration**: Session**Type**: HTML Local Storage
        
        **yt-remote-session-app \[x2\]**Stores the user's video player preferences using embedded YouTube video
        
        **Maximum Storage Duration**: Session**Type**: HTML Local Storage
        
        **yt-remote-session-name \[x2\]**Stores the user's video player preferences using embedded YouTube video
        
        **Maximum Storage Duration**: Session**Type**: HTML Local Storage
        
    *   [x.clearbitjs.com\
        \
        6](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **\_\_tld\_\_**Used to track visitors on multiple websites, in order to present relevant advertisement based on the visitor's preferences.
        
        **Maximum Storage Duration**: Session**Type**: HTTP Cookie
        
        **cb\_anonymous\_id**Collects data on visitor behaviour from multiple websites, in order to present more relevant advertisement - This also allows the website to limit the number of times that they are shown the same advertisement.
        
        **Maximum Storage Duration**: 1 year**Type**: HTTP Cookie
        
        **cb\_group\_id**Collects data on visitors. This information is used to assign visitors into segments, making website advertisement more efficient.
        
        **Maximum Storage Duration**: 1 year**Type**: HTTP Cookie
        
        **cb\_user\_id**Collects data on visitor behaviour from multiple websites, in order to present more relevant advertisement - This also allows the website to limit the number of times that they are shown the same advertisement.
        
        **Maximum Storage Duration**: 1 year**Type**: HTTP Cookie
        
        **cb\_group\_properties**Collects data on visitor behaviour from multiple websites, in order to present more relevant advertisement - This also allows the website to limit the number of times that they are shown the same advertisement.
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
        **cb\_user\_traits**Collects data on visitor behaviour from multiple websites, in order to present more relevant advertisement - This also allows the website to limit the number of times that they are shown the same advertisement.
        
        **Maximum Storage Duration**: Persistent**Type**: HTML Local Storage
        
    
*   Unclassified 1
    
    Unclassified cookies are cookies that we are in the process of classifying, together with the providers of individual cookies.
    
    *   [tiptap.dev\
        \
        1](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
        
        **tiptap\_pro\_session**Pending
        
        **Maximum Storage Duration**: 1 day**Type**: HTTP Cookie
        
    

[Cross-domain consent2](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#)
 Your consent applies to the following domains:

List of domains your consent applies to:

[cloud.tiptap.dev](https://cloud.tiptap.dev/)

[tiptap.dev](https://tiptap.dev/)

Cookie declaration last updated on 3/13/25 by [Cookiebot](https://www.cookiebot.com/ "Cookiebot")

\[#IABV2\_TITLE#\]

\[#IABV2\_BODY\_INTRO#\]

\[#IABV2\_BODY\_LEGITIMATE\_INTEREST\_INTRO#\]

\[#IABV2\_BODY\_PREFERENCE\_INTRO#\]

\[#IABV2\_LABEL\_PURPOSES#\]

\[#IABV2\_BODY\_PURPOSES\_INTRO#\]

\[#IABV2\_BODY\_PURPOSES#\]

\[#IABV2\_LABEL\_FEATURES#\]

\[#IABV2\_BODY\_FEATURES\_INTRO#\]

\[#IABV2\_BODY\_FEATURES#\]

\[#IABV2\_LABEL\_PARTNERS#\]

\[#IABV2\_BODY\_PARTNERS\_INTRO#\]

\[#IABV2\_BODY\_PARTNERS#\]

About

  

  
  

**Do not sell or share my personal information**

Allow allCustomize

Allow selectionDeny

Tired of playing "spot the difference" with your document versions?

The Snapshot Compare extension adds extra functionality to the [Document History](https://tiptap.dev/docs/collaboration/documents/history)
 by allowing you to visually compare changes made between two versions of a document so you can track what’s been added, removed, or modified. These comparisons are called _diffs_.

Whether you're collaborating with a team or editing solo, this helps you track changes over time and understand who made specific edits. By highlighting differences within the editor and attributing them to their authors, Snapshot Compare brings transparency and efficiency to the document lifecycle.

[](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#install)
Install
------------------------------------------------------------------------------------

### Subscription required

This extension requires a valid Entry, Business or Enterprise subscription and a running [Tiptap Cloud instance](https://cloud.tiptap.dev/)
. To install the extension you need [access to our private registry](https://tiptap.dev/docs/guides/pro-extensions)
, set this up first.

Install the extension from our private registry:

    npm install @tiptap-pro/extension-snapshot-compare
    

[](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#settings)
Settings
--------------------------------------------------------------------------------------

You can configure the `SnapshotCompare` extension with the following options:

| Setting | Type | Default | Description |
| --- | --- | --- | --- |
| provider | `TiptapCollabProvider` | `null` | The Collaboration provider instance |
| mapDiffToDecorations | `function` | `() => {}` | Control mapping a diff into a decoration to display their content |

    const provider = new TiptapCollabProvider({
      // ...
    })
    
    const editor = new Editor({
      // ...
      extensions: [\
        // ...\
        SnapshotCompare.configure({\
          provider,\
        }),\
      ],
    })
    

#### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#using-mapdifftodecorations-for-diff-decorations)
Using `mapDiffToDecorations` for diff decorations

The extension has a default mapping (`defaultMapDiffToDecorations`) to represent diffs as ProseMirror decorations. For more complex integrations and control, you can customize this mapping with the `mapDiffToDecorations` option.

**Example:** Applying custom predefined background colors to inline inserts

    SnapshotCompare.configure({
      mapDiffToDecorations: ({ diff, tr, editor, defaultMapDiffToDecorations }) => {
        if (diff.type === 'inline-insert') {
          // return prosemirror decoration(s) or null
          return Decoration.inline(
            diff.from,
            diff.to,
            {
              class: 'diff',
              style: {
                backgroundColor: diff.attribution.color.backgroundColor,
              },
            },
            // pass the diff as the decoration's spec, this is required for `extractAttributeChanges`
            { diff },
          )
        }
    
        // fallback to the default mapping
        return defaultMapDiffToDecorations({
          diff,
          tr,
          editor,
          attributes: {
            // add custom attributes to the decorations
            'data-tiptap-user-id': myUserIdMapping[diff.attribution.userId],
          },
        })
      },
    })
    

[](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#storage)
Storage
------------------------------------------------------------------------------------

The `SnapshotCompare` storage object contains the following properties:

| Key | Type | Description |
| --- | --- | --- |
| isPreviewing | `boolean` | Indicates whether the diff view is active |
| diffs | `Diff[]` | The diffs that are displayed in the diff view |
| previousContent | `JSONContent \| null` | The content before the diff view was applied |

Use the `isPreviewing` property to check if the diff view is currently active:

    if (editor.storage.snapshotCompare.isPreviewing) {
      // The diff view is currently active
    }
    

Use the `diffs` property to access the diffs displayed in the diff view:

    editor.storage.snapshotCompare.diffs
    

The property `previousContent` is used internally by the extension to restore the content when exiting the diff view. Typically, you do not need to interact with it directly.

[](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#commands)
Commands
--------------------------------------------------------------------------------------

| Command | Description |
| --- | --- |
| `compareVersions` | Diffs two versions and renders the diff within the editor |
| `showDiff` | Given a change tracking transform, show the diff within the editor |
| `hideDiff` | Hide the diff and restore the previous content |

### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#compareversions)
compareVersions

Use the `compareVersions` command to compute and display the differences between two document versions.

    editor.chain().compareVersions({
      fromVersion: 1,
    })
    

#### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#options)
Options

You can pass in additional options for more control over the diffing process:

| Key | Description |
| --- | --- |
| `fromVersion` | The version to compare from. The order between `fromVersion` and `toVersion` is flexible |
| `toVersion` | The version to compare to (default: latest version) |
| `hydrateUserData` | Add contextual data to each user's changes |
| `onCompare` | Handle the diffing result manually |
| `enableDebugging` | Enable verbose logging for troubleshooting |

#### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#using-hydrateuserdata-to-add-metadata)
Using `hydrateUserData` to add metadata

Each diff has an `attribution` field, which allows you to add additional metadata with the `hydrateUserData` callback function.

### Note

Do note that the `userId` is populated by the `TiptapCollabProvider` and should be used to identify the user who made the change. Without the `user` field provided by the provider, the `userId` will be `null`. [See more information in the TiptapCollabProvider documentation](https://tiptap.dev/docs/collaboration/provider/integration)
.

**Example:** Color-coding diffs based on user

    const colorMapping = new Map([\
      ['user-1', '#ff0000'],\
      ['user-2', '#00ff00'],\
      ['user-3', '#0000ff'],\
    ])
    
    editor.chain().compareVersions({
      fromVersion: 1,
      toVersion: 3,
      hydrateUserData: ({ userId }) => {
        return {
          color: {
            backgroundColor: colorMapping.get(userId),
          },
        }
      },
    })
    
    editor.storage.snapshotCompare.diffs[0].attribution.color.backgroundColor // '#ff0000'
    

#### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#using-oncompare-to-customize-the-diffing-process)
Using `onCompare` to customize the diffing process

If you need more control over the diffing process, use the `onCompare` option to receive the result and handle it yourself.

**Example:** Filtering diffs by user

    editor.chain().compareVersions({
      fromVersion: 1,
      toVersion: 3,
      onCompare: (ctx) => {
        if (ctx.error) {
          // handle errors that occurred in the diffing process
          console.error(ctx.error)
          return
        }
    
        // filter the diffs to display only the changes made by a specific user
        const diffsToDisplay = ctx.diffSet.filter((diff) => diff.attribution.userId === 'user-1')
    
        editor.commands.showDiff(ctx.tr, { diffs: diffsToDisplay })
      },
    })
    

### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#showdiff)
showDiff

Use the `showDiff` command to display the diff within the editor using a change tracking transform (`tr`). This represents all of the changes made to the document since the last snapshot. You can use this transform to show the diff in the editor.

Typically, you use this command after customizing or filtering diffs with `compareVersions`, `onCompare`.

The `showDiff` command temporarily replaces the current editor content with the diff view, showing the differences between versions. It also stashes the content currently displayed in editor so that you can restore it later.

    // This will display the changes that change tracking transform recorded in the editor
    editor.commands.showDiff(tr)
    

### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#options)
Options

You can pass additional options to control how the diffs are displayed:

| Key | Description |
| --- | --- |
| diffs | An array of diffs to visualize |

**Example:** Displaying specific diffs

    // This will display only the diffs made by the user with the ID 'user-1'
    const diffsToDisplay = tr.toDiff().filter((diff) => diff.attribution.userId === 'user-1')
    
    editor.commands.showDiff(tr, { diffs: diffsToDisplay })
    

### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#hidediff)
hideDiff

Use the `hideDiff` command to hide the diff and restore the previous content.

    // This will hide the diff view and restore the previous content
    editor.commands.hideDiff()
    

[](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#working-with-nodeview-advanced)
Working with NodeView (Advanced)
------------------------------------------------------------------------------------------------------------------------------------

When using [custom node views](https://tiptap.dev/docs/editor/extensions/custom-extensions/node-views)
, the default diff mapping may not work as expected. You can customize the mapping and render the diffs directly within the custom node view.

Use the `extractAttributeChanges` helper to extract attribute changes in nodes. This allows you to access the previous and current attributes of a node, making it possible to highlight attribute changes within your custom node views.

### Note

When mapping the diffs into decorations yourself, you need to pass the `diff` as the decoration's `spec`. This is required for `extractAttributeChanges` to work correctly.

**Example:** Customizing a heading node view to display changes

    import { extractAttributeChanges } from '@tiptap-pro/extension-snapshot-compare'
    
    const Heading = BaseHeading.extend({
      addNodeView() {
        return ReactNodeViewRenderer(({ node, decorations }) => {
          const { before, after, isDiffing } = extractAttributeChanges(decorations)
    
          return (
            <NodeViewWrapper style={{ position: 'relative' }}>
              {isDiffing && before.level !== after.level && (
                <span
                  style={{
                    position: 'absolute',
                    right: '100%',
                    fontSize: '14px',
                    color: '#999',
                    backgroundColor: '#f0f0f070',
                  }}
                  // Display the difference in level attribute
                >
                  #<s>{before.level}</s>
                  {after.level}
                </span>
              )}
              <NodeViewContent as={`h${node.attrs.level ?? 1}`} />
            </NodeViewWrapper>
          )
        })
      },
    })
    

[](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#technical-details)
Technical details
--------------------------------------------------------------------------------------------------------

### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#diff)
Diff

A `Diff` is an object that represents a change made to the document. It contains the following properties:

| Property | Type | Description |
| --- | --- | --- |
| `type` | `'inline-insert'` \| `'inline-delete'` \| `'block-insert'` \| `'block-delete'` \| `'inline-update'` \| `'block-update'` | The type of change made |
| `from` | `number` | The start position of the change |
| `to` | `number` | The end position of the change |
| `content` | `Fragment` | The content that was added or removed |
| `attribution` | `Attribution` | Metadata about the change, such as the user who made the change |
| `attributes?` | `Record<string, any>` | The attributes **after** the change; only available for `'inline-update'` and `'block-update'` diffs |
| `previousAttributes?` | `Record<string, any>` | The attributes **before** the change; only available for `'inline-update'` and `'block-update'` diffs |

### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#diffset)
DiffSet

A `DiffSet` is an array of `Diff` objects, each corresponding to a specific change, like insertion, deletion, or update. You can iterate over the array to inspect individual changes or apply custom logic based on the diff types.

    const diffsToDisplay = diffSet.filter((diff) => diff.attribution.userId === 'user-1')
    
    // Show the filtered diffs in the editor
    editor.commands.showDiff(tr, { diffs: diffsToDisplay })
    

### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#attribution)
Attribution

The `Attribution` object contains metadata about a change. It includes the following properties:

| Property | Type | Description |
| --- | --- | --- |
| `type` | `'added'` \| `'removed'` | Indicates the type of change made |
| `userId` | `string` \| `undefined` | The ID of the user who made the change |
| `id` | `Y.ID` \| `undefined` | The Y.js client ID of the user who made the change |

You can extend the `Attribution` interface to include additional properties:

    declare module '@tiptap-pro/extension-snapshot-compare' {
      interface Attribution {
        userName: string
      }
    }
    

### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#changetrackingtransform)
ChangeTrackingTransform

The `ChangeTrackingTransform` is a class that records changes made to the document (based on ProseMirror's `Transform`). It represents a transform whose steps describe all of the changes made to go from one version of the document to another. It has the following properties:

| Property | Type | Description |
| --- | --- | --- |
| `steps` | `ChangeTrackingStep[]` | An array of steps that represent the changes made to the document |
| `doc` | `Node` | The document **after** the changes have been applied |
| `before` | `Node` | The document **before** the changes have been applied |

### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#changetrackingstep)
ChangeTrackingStep

The `ChangeTrackingStep` is a class that represents a single change made to the document, based on ProseMirror's `ReplaceStep` class. It has the following property:

| Property | Type | Description |
| --- | --- | --- |
| `attribution` | `Attribution` | Metadata about the change, such as the user who made it |

### [](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#types)
Types

Here is the full TypeScript definition for the `SnapshotCompare` extension:

    declare module '@tiptap/core' {
      interface Commands<ReturnType> {
        snapshotCompare: {
          /**
           * Given a change tracking transform, show the diff within the editor
           */
          showDiff: (tr: ChangeTrackingTransform, options?: { diffs?: DiffSet }) => ReturnType
          /**
           * Hide the diff and restore the previous content
           */
          hideDiff: () => ReturnType
          /**
           * Diffs two versions and renders the diff into the editor
           */
          compareVersions: <
            T extends Pick<Attribution, 'color'> & Record<string, any> = Pick<Attribution, 'color'> &
              Record<string, any>,
          >(options: {
            /**
             * The version to start the diff from
             */
            fromVersion: number
            /**
             * The version to end the diff at
             * If not provided, the latest snapshot will be used
             */
            toVersion?: number
            /**
             * Allows adding contextual data to each users changes
             */
            hydrateUserData?: (context: {
              /**
               * The type of event
               */
              type: 'added' | 'removed'
              /**
               * The userId that manipulated this content
               */
              userId: string | undefined
              /**
               * The yjs identifier of the content
               */
              id?: y.ID
            }) => T
            /**
             * If provided, allows customizing the behavior of rendering the diffs to the editor.
             * @note The default behavior would be to just display the diff immediately.
             */
            onCompare?: (
              context:
                | {
                    error?: undefined
                    /**
                     * The editor instance
                     */
                    editor: Editor
                    /**
                     * All of the changes as a transform with attribution metadata
                     */
                    tr: ChangeTrackingTransform<Attribution & T>
                    /**
                     * The changes represented as an array of diffs
                     */
                    diffSet: DiffSet<Attribution & T>
                  }
                | {
                    error: Error
                  },
            ) => void
            /**
             * Verbosely log the diffing process to help track down where things went wrong
             */
            enableDebugging?: boolean
          }) => ReturnType
        }
      }
    }
    
    export type SnapshotCompareOptions = {
      /**
       * The tiptap provider instance. This is required for the extension to compute the diffs, but not to display them.
       * It is also possible to pass a TiptapCollabProvider instance.
       */
      provider: TiptapCollabProvider | null
      /**
       * This allows you to control mapping of a diff into a decoration to display the content of that diff
       */
      mapDiffToDecorations?: (options: {
        /**
         * The diff to map to a decoration
         */
        diff: Diff
        /**
         * The editor instance
         */
        editor: Editor
        /**
         * The change tracking transform
         */
        tr: ChangeTrackingTransform
        /**
         * The default implementation of how to map a diff to a decoration
         */
        defaultMapDiffToDecorations: typeof defaultMapDiffToDecorations
      }) => ReturnType<typeof defaultMapDiffToDecorations>
    }
    
    export type SnapshotCompareStorageInactive = {
      /**
       * Whether the diff view is currently active
       */
      isPreviewing: false
      /**
       * The content before the diff view was applied
       */
      previousContent: null
      /**
       * The change tracking transform that was applied
       * It is currently empty because the diff view is not active
       */
      diffs: DiffSet
      /**
       * The change tracking transform that was applied
       */
      tr: null
    }
    
    export type SnapshotCompareStorageActive = {
      /**
       * Whether the diff view is currently active
       */
      isPreviewing: true
      /**
       * The content before the diff view was applied
       */
      previousContent: JSONContent
      /**
       * The change tracking transform that was applied
       */
      diffs: DiffSet
      /**
       * The change tracking transform that was applied
       */
      tr: ChangeTrackingTransform
    }
    
    export type SnapshotCompareStorage = SnapshotCompareStorageInactive | SnapshotCompareStorageActive
    

On this page

[Introduction](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#page-title)
[Install](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#install)
 [Settings](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#settings)
 [Storage](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#storage)
 [Commands](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#commands)
 [Working with NodeView (Advanced)](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#working-with-nodeview-advanced)
 [Technical details](https://tiptap.dev/docs/collaboration/documents/snapshot-compare#technical-details)

![Cookiebot session tracker icon loaded](https://imgsct.cookiebot.com/1.gif?dgi=73ee9606-0ee4-41ab-85ee-7626f8741637)